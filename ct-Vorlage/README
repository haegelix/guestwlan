WLAN-Butler
Raspberry Pi als Gäste-WLAN-Automat
c't 10/16, S. 98
-----------------------------------------------------------
tl;dr:
  sudo dpkg -i python-kivy*.deb
  sudo apt-get -y -f install
  sudo apt-get -y install qrencode imagemagick
  sed -i -e "s/heise-gaeste/IhreWlanSsid/" g*wlan.* wlankeygen
  sudo mkdir -p /root/.kivy /var/guestwlan/images
  sudo cp config.ini /root/.kivy/
  sudo cp guestwlan.* wlankeygen /usr/local/bin/
  echo "0 6 * * * /usr/local/bin/wlankeygen" | sudo crontab -
  sudo /usr/local/bin/wlankeygen
  sudo cp getty*service /lib/systemd/system/
-----------------------------------------------------------
Bitte verwenden Sie das Paket python-kivy aus diesem Paket für
Raspbian ab dem Release vom 27.05.2016, da das Paket aus dem
Standard-Repository keine Konsolenunterstützung für den Raspberry
Pi mehr enthält. Installation:
  sudo dpkg -i python-kivy*.deb
  sudo apt-get -f install

Die Dateien guestwlan.* und wlankeygen gehören ins Verzeichnis
/usr/local/bin. Standard-SSID ist heise-gaeste, Sie müssen
diese unbedingt durch ihre eigene SSID ersetzen (Suchen/Ersetzen),
auch in der Datei wlankeygen, die Sie ebenfalls nach /usr/local/bin
kopieren und als Cron-Job täglich zum Auswechseln der WLAN-Keys
und Erzeugen der QR-Codes verwenden. Aufgrund eines Problems mit
schwarz-weißen PNG-Grafiken in Kivy 1.8.0 müssen die QR-Codes als
JPEG-Grafiken gespeichert werden, weshalb Sie das Paket imagemagick
aus dem Standard-Repository nachinstallieren müssen.

Zudem müssen Sie mittels
  mkdir -p /var/guestwlan/images
das Bilderverzeichnis für den Automaten anlegen. Dort hineinkopierte
Dateien zeigt der Automat als Diashow an.

Die Vorlagendatei guestwlan.mobileconfig.in gehört in das
Verzeichnis /var/www/html und dient als Grundlage für die
iOS-Verbindungsprofile -- weshalb Sie die SSID dort unbedingt
anpassen müssen. Damit der QR-Code für iOS auf die richtige URL zum
Download der Konfiguration verweist, müssen Sie den Hostnamen zusätzlich
anpassen.

Die Systemd-Datei getty@.service gehört in das Verzeichnis /lib/systemd/system
und sorgt dafür, dass der Gäste-WLAN-Automat automatisch auf dem Terminal
gestartet wird. Gleichzeitig unterbindet sie jedes weitere Login über
den Touchscreen.

Die Verzeichnisse 1-* bis 4-* enthalten die Beispiele aus dem Artikel
zum Ausprobieren. Aufruf: python main.py
